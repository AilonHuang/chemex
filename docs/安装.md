# 安装

> chemex 是个标准的 Laravel应用程序，也适用于所有的 LNMP/WNMP/DNMP 环境，虽然部署方式有很多，但仍然强烈建议使用 Docker
> 方式部署。

## Docker

Docker 部署方式不会建立数据库容器，也意味着你必须有一个已有的数据库，在启动 chemex 时候通过参数注入的方式连接数据库。

`docker pull celaraze/chemex:latest`

```
docker run -itd --restart=always -p 80:80 \
-e DB_HOST=数据库地址 \
-e DB_PORT=数据库端口 \
-e DB_DATABASE=数据库名称 \
-e DB_USERNAME=数据库账户 \
-e DB_PASSWORD=数据库密码 \
celaraze/chemex
```

即可通过 `http://127.0.0.1` 访问 chemex。

## 手动部署

### 先决条件

git：用于管理版本，部署和升级必要工具。

PHP：仅支持 PHP8。

composer：PHP 的包管理工具，用于安装必要的依赖包。

MySQL 5.7：数据库引擎，理论上 MariaDB 10.2 + 兼容支持。

ext-zip：扩展。

ext-json：扩展。

ext-fileinfo：扩展。

ext-ldap：扩展。

ext-bcmath：扩展。

ext-mysqli：扩展。

ext-xml：扩展。

ext-xmlrpc：扩展。

以上扩展安装过程注意版本必须与 PHP 版本一致。

### 安装步骤

生产环境下为遵守安全策略，非常建议在服务器本地进行部署，暂时不提供相关线上初始化安装的功能。因此，虽然前期部署的步骤较多，但已经为大家自动化处理了很大部分的流程，只需要跟着下面的命令一步步执行，一般是不会有部署问题的。

1. 为你的计算机安装 `PHP8` 环境，参考：[PHP官方](https://www.php.net/downloads) 。

2. 为你的计算机安装 `MySQL` 或者 `mariadb`。

3. 在你想要的地方，执行 `mkdir chemex && cd chemex`。

4. 执行 `git clone https://gitee.com/celaraze/chemex.git .`，注意末尾的 `.` 也是需要包含的。

5. 执行 `git submodule init && git submodule update`。

6. 执行 `cp .env.example .env`。

7. 根据 `.env` 文件中注释的指引进行配置。

8. 执行 `composer update -vvv`。

9. 你可能使用的web服务器为 `nginx` 以及 `apache`，无论怎样，应用的起始路径在 `/public` 目录，请确保指向正确，同时程序的根目录权限应该调整为：拥有者和你的
   Web 服务器运行用户一致，例如 www
   用户，且根目录权限为 `755`。

   `/storage` 目录设置为 `755` 权限。

   `/public` 目录设置为 `755` 权限。

10. 修改web服务器的伪静态规则为：`try_files $uri $uri/ /index.php?$args;`。

11. 执行 `php artisan chemex:install`。

12. 此时可以通过访问 `http://your_domain` 来使用咖啡壶。管理员账号密码为：`admin / admin`。
